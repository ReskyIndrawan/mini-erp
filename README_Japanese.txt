================================================================================
                          Mini ERP - 不良品データ 管理システム
================================================================================

【概要】
Mini ERPはPythonベースのデスクトップアプリケーションで、Tkinterを使用して開発されました。
不良品データ（Furyo Hin Data）を管理するために設計されています。
このアプリケーションは、製造環境での問題製品の文書化と追跡プロセスを支援するために特別に設計されています。

このアプリケーションは2つの主要な機能を提供します：
1. テンプレート生成 - データ記録用のExcelテンプレートを作成
2. 不良品データ入力 - 不良品データを入力・管理

【システム要件】
- Python 3.7以上
- 必要なライブラリ：
  - openpyxl>=3.1.5
  - tkinter（通常はPythonインストールに含まれています）

【インストール方法】
1. システムにPythonがインストールされていることを確認
2. 必要なライブラリをインストール：
   pip install openpyxl
3. アプリケーションを実行：
   python main.py

================================================================================
                           ユーザーガイド
================================================================================

【1. テンプレート生成タブ】
このタブは、不良品データ記録用の新しいExcelテンプレートを作成するために使用します。

【インターフェースコンポーネント：】
• 作成者 - 作成者/ユーザー名の入力フィールド
• 保存先ディレクトリ - 選択された保存ディレクトリを表示するラベル
• 参照 - 保存ディレクトリを選択するボタン
• Excel作成 - Excelテンプレートファイルを作成するボタン

【使用方法：】
1. 作成者フィールドに名前を入力
2. 参照ボタンをクリックして保存ディレクトリを選択
3. ディレクトリが選択されると、パスが保存先ディレクトリラベルに表示されます
4. Excel作成ボタンをクリックしてテンプレートを作成

【ボタン押下時の動作：】
• Excel作成：
  - 入力検証：作成者名が空の場合、またはディレクトリが未選択の場合、エラーメッセージが表示されます
  - YYYY-MM-不良品データ形式のフォルダを作成（例：2024-09-不良品データ）
  - その中に不良発生連絡書発行サブフォルダを作成
  - フォーマット済みテンプレートで不具合品一覧表.xlsxファイルを作成
  - サンプルとしてダミー行を追加
  - 作成されたファイルのパスを含む成功メッセージを表示

================================================================================

【2. 不良品データ入力タブ】
このタブは、Excelファイルに記録された不良品データを入力、管理、検索するために使用します。

【インターフェースコンポーネント：】

【ファイル選択部分：】
• Excelファイル - 履歴からExcelファイルを選択するドロップダウン
• Excel検索 - 新しいExcelファイルを検索するボタン
• シート - Excelファイル内のシートを選択するドロップダウン
• 履歴 - 過去に開いたファイルの履歴を表示/管理する大きいボタン

【データ入力部分：】
• 発生月 - 問題発生月を選択するドロップダウン
• 累計 - 累計合計を表示するフィールド（自動入力）
• № - 連番フィールド（自動入力）
• 発生日 - 問題発生日のフィールド（日付ピッカー付き）
• 項目 - 問題カテゴリのフィールド
• 事象 - 問題の主要な説明のフィールド
• 事象（一次） - 問題の一次説明のフィールド
• 事象（二次） - 問題の二次説明のフィールド
• 品番 - 製品品番のフィールド
• サプライヤー名 - サプライヤー名のフィールド
• 不良発生連絡書発行 - 報告書が発行済みかどうかを示すチェックボックス
• 不良発生№ - 報告書番号のフィールド

【アクションボタン：】
• 保存（追加） - 新しいデータを保存
• 更新（編集） - 選択したデータを更新
• 削除 - 選択したデータを削除
• クリア - すべての入力フィールドをクリア
• フィルタ - フィルタダイアログを開く

【プレビュー部分：】
• Excelデータプレビュー - Excelファイルからのデータを表示するテーブル

【使用方法：】

【Excelファイルを開く：】
1. Excelファイルドロップダウンをクリックして履歴からファイルを選択、または
2. Excel検索ボタンをクリックして新しいExcelファイルを検索
3. シートドロップダウンから目的のシートを選択

【新しいデータを入力：】
1. 必要なすべてのフィールドに入力：
   - 発生月をドロップダウンから選択
   - 発生日フィールドをクリックして日付ピッカーから日付を選択
   - 項目、事象、事象（一次）、事象（二次）を入力
   - 品番とサプライヤー名を入力
   - 発行済みの場合は不良発生連絡書発行にチェック
   - 不良発生№があれば入力
2. 保存（追加）ボタンをクリックして保存

【データを編集：】
1. プレビューテーブルのデータ行をクリック
2. データが入力フォームに自動的に入力されます
3. 必要な変更を行う
4. 更新（編集）ボタンをクリックして変更を保存

【データを削除：】
1. プレビューテーブルのデータ行をクリック
2. データが入力フォームに自動的に入力されます
3. 削除ボタンをクリックしてデータを削除（確認ダイアログが表示されます）

【フィルタを使用：】
1. フィルタボタンをクリック
2. フィルタダイアログで以下の操作が可能：
   - 日付範囲を選択（発生日：から〜まで）
   - フリーテキスト検索を実行
   - 追加フィルタ用のPDF/Excelファイルを選択
3. フィルタ適用をクリックしてフィルタを適用

【ボタン押下時の動作：】

• Excel検索：
  - ファイル選択ダイアログを開いてExcelファイルを選択
  - 選択されたファイルが履歴に追加されます
  - ファイル内の利用可能なシートを読み込みます

• 履歴：
  - 過去に開いた10ファイルの履歴を表示するダイアログを開く
  - 履歴からアイテムを削除可能
  - 履歴からファイルを選択して開くことが可能

• 保存（追加）：
  - 必要なすべてのフィールドを検証
  - 新しいデータをExcelファイルに追加
  - プレビュー表示を更新
  - 入力フォームをクリア

• 更新（編集）：
  - Excelファイルの既存データを更新
  - プレビュー表示を更新
  - 入力フォームをクリア

• 削除：
  - 確認ダイアログを表示
  - Excelファイルからデータを削除
  - プレビュー表示を更新
  - 入力フォームをクリア

• クリア：
  - すべての入力フィールドをクリア
  - プレビューテーブルの選択を解除

• フィルタ：
  - さまざまなオプションを持つフィルタダイアログを開く
  - フィルタ結果がプレビューテーブルに表示されます

================================================================================
                              追加機能
================================================================================

【日付ピッカー】
発生日フィールドをクリックすると、インタラクティブなカレンダーを使用して日付を簡単に選択できる日付ピッカーが表示されます。

【ファイル履歴管理】
アプリケーションは自動的に過去に開いたExcelファイルの履歴を保存します（最大10ファイル）。
この履歴は以下の場所に保存されます：
- Windows: %APPDATA%\defect_data_app\recent_excel_files.json
- Linux/macOS: ~/.config/defect_data_app/recent_excel_files.json

【自動番号付け】
№フィールドと累計フィールドは、Excelファイルに既存のデータに基づいて自動的に入力されます。

【データ検証】
アプリケーションは保存前にデータ検証を行います：
- 必須フィールドは入力必須
- 日付形式は有効である必要があります
- Excelファイルが存在し、読み取り可能である必要があります

================================================================================
                              トラブルシューティング
================================================================================

【ファイルが開けない場合】
- Excelファイルが他のアプリケーションで開かれていないことを確認
- ファイルが正しい形式（.xlsx）であることを確認
- ファイルが破損していないことを確認

【保存時にエラーが発生する場合】
- ディレクトリに書き込み権限があることを確認
- Excelファイルが読み取り専用モードでないことを確認
- ディスク容量が十分であることを確認

【プレビューにデータが表示されない場合】
- Excelファイルとシートが正しく選択されていることを確認
- 選択したシートにデータがあることを確認
- ファイルを再び開いてリフレッシュしてみる

================================================================================
                           Excelファイル構造
================================================================================

作成されるExcelファイルは以下の列構造を持っています：
1. No
2. 発生月（発生月）
3. 累計（累計合計）
4. 発生日（発生日）
5. 項目（カテゴリ）
6. 事象（説明）
7. 事象（一次）（一次説明）
8. 事象（二次）（二次説明）
9. 品番（品番）
10. サプライヤー名（サプライヤー名）
11. 不良発生連絡書発行（報告ステータス）
12. 不良発生№（報告番号）

================================================================================
                                 サポート
================================================================================

問題が発生した場合や質問がある場合は、上記のトラブルシューティングセクションを確認するか、
システム管理者に連絡してください。

================================================================================